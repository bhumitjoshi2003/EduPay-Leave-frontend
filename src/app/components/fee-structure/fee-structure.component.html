<div class="fee-structure-container">
  <div class="header">
    <h2>School Fee Structure {{currentSession}}</h2>

    <div class="actions">
      <div class="session-select-wrapper">
        <label for="session-select">Academic Session:</label>
        <select id="session-select" [(ngModel)]="currentSession" (change)="changeSession(currentSession)">
          <option *ngFor="let session of sessions" [value]="session">{{ session }}</option>
        </select>
      </div>

      <button *ngIf="!(isNewSessionStarted || isEditing) && canEdit()" (click)="startNewAcademicYear()">Start New Academic Year</button>
      <button *ngIf="!isEditing && canEdit()" (click)="edit()">Edit</button>

      <div *ngIf="isEditing" class="edit-actions">
        <button (click)="save()">Save</button>
        <button (click)="cancel()">Cancel</button>
        <button (click)="addRow()">Add Row</button>
        <button (click)="removeRow()">Remove Row</button>
      </div>
    </div>
  </div>

  <div class="tables-container">
    <div class="fee-table-section">
      <table class="fee-table">
        <thead>
          <tr>
            <th>Class</th>
            <th>Tuition Fee</th>
            <th>Admission Fee</th>
            <th>Annual Charges</th>
            <th>E.C.A (Project)</th>
            <th>Examination Fee</th>
            <th>Lab Charges</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let fee of feeStructures">
            <td>
              <input *ngIf="isEditing" type="text" [(ngModel)]="fee.className" />
              <span *ngIf="!isEditing">{{ fee.className }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.tuitionFee" />
              <span *ngIf="!isEditing">{{ fee.tuitionFee }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.admissionFee" />
              <span *ngIf="!isEditing">{{ fee.admissionFee }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.annualCharges" />
              <span *ngIf="!isEditing">{{ fee.annualCharges }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.ecaProject" />
              <span *ngIf="!isEditing">{{ fee.ecaProject }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.examinationFee" />
              <span *ngIf="!isEditing">{{ fee.examinationFee }}</span>
            </td>
            <td>
              <input *ngIf="isEditing" type="number" [(ngModel)]="fee.labCharges" />
              <span *ngIf="!isEditing">{{ fee.labCharges }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="bus-fees-table-section">
      <app-bus-fees></app-bus-fees>
    </div>
  </div>
</div>